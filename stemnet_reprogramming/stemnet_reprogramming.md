Reprogramming blood cell types
------------------------------

This tutorial describes how to apply CellRouter to a human single-cell
RNA-sequencing dataset generated by Velten et al. (Nature Cell Biology
2017). The analysis reported here reproduces the trajectory analysis
presented in Figure 5 of our manuscript (Lummertz da Rocha et al, Nature
Communications 2018). In your working directory, create a folder names
"results". Then, inside the folder results, create a folder named
"paths".

Install STEMNET
---------------

This tutorial requires that STEMNET is installed. Instructions to
install STEMNET can be found here: <https://git.embl.de/velten/STEMNET>.
Additional information to use STEMNET can be found here:
<https://git.embl.de/velten/STEMNET/blob/master/vignettes/VeltenHaasRaffel_Reproducible.Rmd>

Dimensionality reduction and cell type annotation using STEMNET
---------------------------------------------------------------

    source('../CellRouter_Class.R')
    libdir <- '../CellRouter/'

    library(DESeq2)
    require(STEMNET)
    require(ggplot2)
    require(cluster)
    require(pheatmap)

    cd38 <- populations[,"CD38+"]
    cd38minus_data <- geneExpression[!cd38,]
    cd38plus_data <- geneExpression[cd38,]

    vars_cd38plus <- apply(cd38plus_data, 2, var)
    vars_cd38plus <- vars_cd38plus[order(vars_cd38plus, decreasing=T)]
    vars_cd38minus <- apply(cd38minus_data, 2, var)
    vars_cd38minus <- vars_cd38minus[order(vars_cd38minus, decreasing=T)]

    colors <- c("CD38+CD10+" = "#F9B233",
                "CD38+CD10-CD45RA+CD135+" = "#F76C34",
                "CD38+CD10-CD45RA-CD135-" = "#E80505",
                "CD38+CD10-CD45RA-CD135+" = "#5B0202",
                "CD38-CD45RA+CD10-" = "#5F6FFF",
                "CD38-CD45RA+CD10+" = "#61C7FF",
                "CD38-CD45RA-CD90-" = "#2D2E83",
                "CD38-CD45RA-CD90dim" = "#8F4DB2",
                "CD38-CD90high" = "black",
                "other" = "lightgrey"
    )

    usepop <- names(colors)[-length(colors)]
    anno_df <- data.frame(class = booleanTable2Character(populations[cd38,usepop]), row.names=rownames(cd38plus_data))
    ann_colors = list(  class =colors )
    callback = function(hc, mat){
      sv = svd(t(mat))$v[,1]
      dend = reorder(as.dendrogram(hc), wts = sv)
      as.hclust(dend)
    }

    ddata <- t(cd38plus_data[,names(vars_cd38plus[1:100])])
    ddata[ddata>10] <- 10

    cd38plus_heatmap <- pheatmap(ddata, color = c(rep("black",15),colorRampPalette(c("black","blue","red","yellow"))(85)), cluster_rows = T, cluster_cols = T, clustering_distance_cols =dist(cd38plus_data[,names(vars_cd38plus[1:1000])]), clustering_distance_rows = "euclidean", annotation_col = anno_df,  annotation_colors=ann_colors, show_rownames=F,show_colnames=F, clustering_method="ward",clustering_callback=callback, cutree_cols = 12,fontsize_row=7)

![](stemnet_reprogramming_files/figure-markdown_strict/stemnet-1.png)

    clusterfunction <- function(x, k) {
      d <- dist(x)
      dendro <- hclust(d, method="ward.D")
      list(cluster = cutree(dendro, k=k))
    }

    webfile <- get(load('gapstat.rda'))
    plf_gap <- data.frame(k = 1:30, gap = gap_cd38plus$Tab[,"gap"], sd = gap_cd38plus$Tab[,"SE.sim"], stringsAsFactors=T)
    gapplot <- ggplot2::qplot(x = k, y= gap, data=plf_gap, geom="line",size=I(0.5)) + ggplot2::theme_classic(base_size=12) + ggplot2::xlab("Cluster number") + ggplot2::geom_ribbon(aes(ymax = gap + sd, ymin=gap-sd), alpha=0.1, color = NA) + ggplot2::ylab(expression(Gap[k])) 
    print(gapplot)

![](stemnet_reprogramming_files/figure-markdown_strict/stemnet-2.png)

    ncluster <- which.max(plf_gap$gap)
    cell_cluster <- cutree(cd38plus_heatmap$tree_col, k=ncluster)

    #create a data frame containing information on the populations
    pop <- cbind(all=T,do.call(cbind, lapply(1:max(cell_cluster), function(x) rep(F, length(cd38)))))

    pop[cd38,] <- cbind(all=T,do.call(cbind, lapply(1:max(cell_cluster), function(x) x == cell_cluster)))
    colnames(pop) <- c("all",paste0("HClust",1:ncluster))

    #manually merge small clusters of <=5 cells with the next bigger cluster:
    pop <- cbind(pop, HClust12_15_18_19_20 = apply(pop[,c("HClust12","HClust15","HClust18","HClust19", "HClust20")],1,any))
    pop <- pop[, !colnames(pop) %in% c("HClust12","HClust15","HClust18","HClust19", "HClust20")]

    colnames(pop) <- c("all","Im-2", "N-1", "Mono/D", "Im-1","ME-2", "N-0","sB-1","Mk", "N-2","ME-3","N-3","E-1","E-2", "G2M","sB-2","Eo/Baso")
    stemnet_pop <- data.frame(
      B = apply(pop[,c("sB-1","sB-2")],1,any),
      `Eo/Baso` = pop[,"Eo/Baso"],
      Erythroid = apply(pop[,c("E-1","E-2")],1,any),
      `Mono/D` = pop[,"Mono/D"],
      Mk =  pop[,"Mk"],
      Neutrophil = apply(pop[,c("N-1","N-2","N-3")],1,any)
    )
    stemnet_pop <- booleanTable2Character(stemnet_pop,other_value=NA)
    stemnet_result <- runSTEMNET(geneExpression, stemnet_pop)
    CAPframe <- plot(stemnet_result)

![](stemnet_reprogramming_files/figure-markdown_strict/stemnet-3.png)

    plotdata <- CAPframe$PlotData
    stemcells <- plotdata[which(plotdata$class==TRUE),]
    endpoint <- plotdata[which(plotdata$class==FALSE),]

    m <- as.data.frame(CAPframe$PlotData[,1:2])
    colnames(m) <- c('tSNE1', 'tSNE2')
    nCounts <- as.data.frame(t(geneExpression))

    genes <- as.vector(unlist(lapply(strsplit(rownames(nCounts), split=" "), "[", 1)))
    geneTab <- data.frame(id=rownames(nCounts), symbol=as.vector(genes))
    nCounts <- averageIds(nCounts, geneTab, 'symbol')

Create CellRouter object
------------------------

    cellrouter <- CellRouter(expdata=as.data.frame(nCounts), annotations=colnames(nCounts))

    ## [1] "Initializing CellRouter object"

    cellrouter@rdimension <- as.data.frame(m)
    cellrouter <- findsubpopulations(cellrouter, 13, 'jaccard', 'results/kNN_network.gml')

    ## [1] "building k-nearest neighbors graph"
    ## [1] "discoverying subpopulation structure"
    ## [1] "plotting graph in RStudio"

![](stemnet_reprogramming_files/figure-markdown_strict/findsubpopulations-1.png)

    ## [1] "done plotting graph"
    ## [1] "updating CellRouter object"

    plotReducedDimension(cellrouter, 3.5, 3.5, filename='results/tSNE.pdf')

![](stemnet_reprogramming_files/figure-markdown_strict/findsubpopulations-2.png)

    cellrouter@sampTab$stemcell <- "Endpoint"
    cellrouter@sampTab[rownames(stemcells), 'stemcell'] <- 'Stem Cell'

    genelist <- c('KLF1', 'PBX1','IRF8', 'ELANE','HLF', 'CD34')
    plotDRExpression2(cellrouter, genelist, FALSE, 2, 5, 4, 'results/stemnet_populations.pdf')

![](stemnet_reprogramming_files/figure-markdown_strict/findsubpopulations-3.png)

    colors <- unique(cellrouter@sampTab$colors)
    names(colors) <- unique(cellrouter@sampTab$stemcell)

    data2 <- data.frame(cells=cellrouter@sampTab$stemcell, classification=cellrouter@sampTab$population)
    data2$classification <- factor(data2$classification, levels=unique(as.vector(data2$classification)))
    pdf(file='results/proportion.pdf', width = 4.7, height=2.5)
    g <- ggplot(data2,aes(x = classification, fill = cells)) + 
      geom_bar(position = "fill", color='black') + 
      theme_bw() + theme(legend.position='right', 
                         legend.key.size = unit(0.3, "cm"), 
                         legend.text=element_text(size=7)) + xlab("") + ylab("Proportion") + 
      theme(axis.text.x = element_text(size=10, angle=45, hjust=1), axis.title.y = element_text(size = rel(1), angle = 90)) + scale_fill_brewer("", palette = 'Paired')
    dev.off()

    ## PNG 
    ##   2

    plot(g)

![](stemnet_reprogramming_files/figure-markdown_strict/findsubpopulations-4.png)

    cellrouter <- createKNN(cellrouter, 10, 'jaccard', 'results/paths/kNN_network_trajectory.gml')

    ## [1] "updating CellRouter object"

    filename <- "results/paths/cell_edge_weighted_network.txt"
    write.table(cellrouter@graph$edges, file=filename, sep='\t', row.names=FALSE, col.names = FALSE, quote=FALSE) #input network

    #selecting starting subpopulation
    sources <- c('SP_8', 'SP_17', 'SP_10', 'SP_9', 'SP_15', 'SP_16')
    targets <- c('SP_12')
    methods <- c("euclidean", "maximum", "manhattan","canberra","binary", 'graph') 
    cellrouter <- findpaths(cellrouter, libdir, paste(getwd(), 'results/paths', sep='/'), method="graph")

    ## --------------------------: SP_8.SP_12 
    ## --------------------------: SP_17.SP_12 
    ## --------------------------: SP_10.SP_12 
    ## --------------------------: SP_9.SP_12 
    ## --------------------------: SP_15.SP_12 
    ## --------------------------: SP_16.SP_12

    ranks <- c('path_cost', 'path_flow', 'rank', 'length')
    genes2use <- rownames(cellrouter@ndata)
    cellrouter <- processtrajectories(cellrouter, genes2use, path.rank=ranks[3], num.cells = 3, neighs = 1)

    ## perform the analysis using all trajectories
    names <- unique(names(cellrouter@pathsinfo$distr))
    clusters.show <- names
    cellrouter <- correlationpseudotime(cellrouter, type='spearman')
    cellrouter <- topgenes(cellrouter, 0.85, 0.15)
    cellrouter <- smoothdynamics(cellrouter, names)
    cellrouter <- clusterGenesPseudotime(cellrouter, 5)
    save(cellrouter, file='results/CellRouter_HSPC_Processed.R')

    ggrn <- buildGRN('Hs', cellrouter@ndata, genes2use, 5, 'results/GRN.R')

    cellrouter <- get(load('results/CellRouter_HSPC_Processed.R'))
    tfs <- find_tfs(species = 'Hs')

    ## matching gene symbols and annotations

    ggrn <- get(load('results/GRN.R'))

    transitions <- c('SP_10.SP_12', 'SP_17.SP_12') #transitions to be analyzed
    x <- grnscores(cellrouter, tfs, transitions,
                   direction='both', flip=TRUE, q.up=0.95, q.down=0.05,
                   dir.targets='up', columns=2, width=5, height=5, 
                   filename='results/HSC_GRN_score')

    ## [1] 0
    ## [1] 0

![](stemnet_reprogramming_files/figure-markdown_strict/grnscore-1.png)

    p <- transitions[[1]]
    m2 <- plottr(cellrouter, p, x[[p]]$scores, cluster=FALSE, 2, 4.5, 5.5, 
                 paste('results/', p, 'up_down_diff_dynamics_1.pdf',sep=''))

![](stemnet_reprogramming_files/figure-markdown_strict/grnscore-2.png)

    p <- transitions[[2]]
    m2 <- plottr(cellrouter, p, x[[p]]$scores, cluster=FALSE, 2, 4.5, 5.5, 
                 paste('results/', p, 'up_down_diff_dynamics_2.pdf',sep=''))

![](stemnet_reprogramming_files/figure-markdown_strict/grnscore-3.png)

    ### We repeat this analysis selecting more potential regulators to include PBX1 
    ## in both transitions in FIgure 5e
    ##load additional libraries
    library('ggnetwork')
    library('GGally')
    library('geomnet')
    library('network')
    library('sna')
    x <- grnscores(cellrouter, tfs, transitions,
                   direction='both', flip=TRUE, q.up=0.90, q.down=0.10,
                   dir.targets='up', columns=2, width=5, height=5, filename='results/HSC_GRN_score')

    ## [1] 0
    ## [1] 0

![](stemnet_reprogramming_files/figure-markdown_strict/grnscore2-1.png)

    regulators <- c('MEIS1', 'GATA2', 'ERG', 'PBX1', 'NRIP1')
    regulatornetwork(x, regulators, 5, 2, 5, 9, 'results/regulator_networks_1.pdf')

![](stemnet_reprogramming_files/figure-markdown_strict/grnscore2-2.png)

    ## $SP_10.SP_12_MEIS1
    ## IGRAPH 5a57608 UNWB 65 369 -- 
    ## + attr: name (v/c), label (v/c), type (v/c), nEnts (v/n), color
    ## | (v/n), size (v/n), weight (e/n)
    ## + edges from 5a57608 (vertex names):
    ##  [1] GATA2 --ZBTB16 GATA2 --HHEX   HHEX  --KHSRP  KHSRP --RPL6  
    ##  [5] GATA2 --MEIS1  ZBTB16--MEIS1  HHEX  --MEIS1  HLF   --MEIS1 
    ##  [9] GTF3A --MEIS1  KHSRP --MEIS1  RPL6  --MEIS1  ILF3  --MEIS1 
    ## [13] HHEX  --YBX1   GTF3A --YBX1   KHSRP --YBX1   ILF3  --YBX1  
    ## [17] MEIS1 --YBX1   GATA2 --PBX1   ZBTB16--PBX1   MEIS1 --PBX1  
    ## [21] HHEX  --ERG    MEIS1 --ERG    MEIS1 --HDAC5  GATA2 --NRIP1 
    ## [25] HHEX  --NRIP1  HLF   --NRIP1  RPL6  --NRIP1  MEIS1 --NRIP1 
    ## + ... omitted several edges
    ## 
    ## $SP_10.SP_12_GATA2
    ## IGRAPH d958562 UNWB 74 285 -- 
    ## + attr: name (v/c), label (v/c), type (v/c), nEnts (v/n), color
    ## | (v/n), size (v/n), weight (e/n)
    ## + edges from d958562 (vertex names):
    ##  [1] GATA2 --LYL1   GATA2 --ZBTB16 GATA2 --NFE2   LYL1  --NFE2  
    ##  [5] ZBTB16--NFE2   GATA2 --HHEX   GATA2 --RNF10  LYL1  --RNF10 
    ##  [9] GATA2 --PHTF1  GATA2 --IKZF2  GATA2 --GFI1B  NFE2  --GFI1B 
    ## [13] GATA2 --MAF1   GATA2 --STAT5A LYL1  --STAT5A NFE2  --STAT5A
    ## [17] RNF10 --STAT5A GFI1B --STAT5A GATA2 --MEIS1  ZBTB16--MEIS1 
    ## [21] HHEX  --MEIS1  GATA2 --PBX1   ZBTB16--PBX1   MEIS1 --PBX1  
    ## [25] GATA2 --TRIM24 LYL1  --TRIM24 PBX1  --TRIM24 GATA2 --NRIP1 
    ## + ... omitted several edges
    ## 
    ## $SP_10.SP_12_ERG
    ## IGRAPH dca18d0 UNWB 47 106 -- 
    ## + attr: name (v/c), label (v/c), type (v/c), nEnts (v/n), color
    ## | (v/n), size (v/n), weight (e/n)
    ## + edges from dca18d0 (vertex names):
    ##  [1] HHEX  --MEIS1    HHEX  --ERG      ZNF169--ERG      TAF10 --ERG     
    ##  [5] MEIS1 --ERG      HHEX  --NRIP1    MEIS1 --NRIP1    ERG   --NRIP1   
    ##  [9] ERG   --RPS3     ERG   --ZNF593   HHEX  --PROM1    ERG   --PROM1   
    ## [13] NRIP1 --PROM1    RPS3  --PROM1    ERG   --SERPINB1 RPS3  --SERPINB1
    ## [17] ERG   --RPL31    RPS3  --RPL31    ERG   --ICAM3    ERG   --FTL     
    ## [21] RPS3  --FTL      ERG   --BLVRB    NRIP1 --BLVRB    ZNF593--BLVRB   
    ## [25] ERG   --RPL3     RPS3  --RPL3     HHEX  --AVP      MEIS1 --AVP     
    ## + ... omitted several edges
    ## 
    ## $SP_10.SP_12_PBX1
    ## IGRAPH dd78d58 UNWB 54 162 -- 
    ## + attr: name (v/c), label (v/c), type (v/c), nEnts (v/n), color
    ## | (v/n), size (v/n), weight (e/n)
    ## + edges from dd78d58 (vertex names):
    ##  [1] GATA2 --ZBTB16   GATA2 --MEIS1    ZBTB16--MEIS1    GATA2 --PBX1    
    ##  [5] ZBTB16--PBX1     MEIS1 --PBX1     GATA2 --TRIM24   PBX1  --TRIM24  
    ##  [9] MEIS1 --FLI1     PBX1  --FLI1     PBX1  --ZNF76    FLI1  --ZNF76   
    ## [13] GATA2 --SERPINB1 ZBTB16--SERPINB1 PBX1  --SERPINB1 TRIM24--SERPINB1
    ## [17] FLI1  --SERPINB1 GATA2 --GUCY1B3  ZBTB16--GUCY1B3  MEIS1 --GUCY1B3 
    ## [21] PBX1  --GUCY1B3  TRIM24--GUCY1B3  FLI1  --GUCY1B3  GATA2 --PTGS1   
    ## [25] ZBTB16--PTGS1    MEIS1 --PTGS1    PBX1  --PTGS1    FLI1  --PTGS1   
    ## + ... omitted several edges
    ## 
    ## $SP_10.SP_12_NRIP1
    ## IGRAPH b6a0621 UNWB 73 444 -- 
    ## + attr: name (v/c), label (v/c), type (v/c), nEnts (v/n), color
    ## | (v/n), size (v/n), weight (e/n)
    ## + edges from b6a0621 (vertex names):
    ##  [1] GATA2--HHEX    GATA2--PHTF1   GATA2--MEIS1   HHEX --MEIS1  
    ##  [5] HLF  --MEIS1   RPL6 --MEIS1   HLF  --GATA3   HHEX --ERG    
    ##  [9] MEIS1--ERG     CBX2 --HDAC5   MEIS1--HDAC5   GATA2--NRIP1  
    ## [13] YBX3 --NRIP1   HHEX --NRIP1   PHTF1--NRIP1   HLF  --NRIP1  
    ## [17] HOXB2--NRIP1   PLAG1--NRIP1   CBX2 --NRIP1   RPL6 --NRIP1  
    ## [21] APEX1--NRIP1   MEIS1--NRIP1   PSIP1--NRIP1   GATA3--NRIP1  
    ## [25] ELK3 --NRIP1   ERG  --NRIP1   HDAC5--NRIP1   YBX3 --ZFP36L2
    ## + ... omitted several edges
    ## 
    ## $SP_17.SP_12_MEIS1
    ## IGRAPH 24023cc UNWB 72 425 -- 
    ## + attr: name (v/c), label (v/c), type (v/c), nEnts (v/n), color
    ## | (v/n), size (v/n), weight (e/n)
    ## + edges from 24023cc (vertex names):
    ##  [1] GATA2 --ZBTB16 GATA2 --HOXA10 GATA2 --MEIS1  ZBTB16--MEIS1 
    ##  [5] ELF1  --MEIS1  HOXA3 --MEIS1  ZNF677--MEIS1  HOXA10--MEIS1 
    ##  [9] H2AFY --MEIS1  ELF1  --SSBP2  MEIS1 --SSBP2  HOXA3 --HOPX  
    ## [13] HOXA10--HOPX   MEIS1 --HOPX   SSBP2 --HOPX   GATA2 --PBX1  
    ## [17] ZBTB16--PBX1   ELF1  --PBX1   MEIS1 --PBX1   MEIS1 --PIAS1 
    ## [21] SSBP2 --PIAS1  MEIS1 --ERG    HOPX  --ERG    HOXA10--HOXA9 
    ## [25] MEIS1 --HOXA9  HOPX  --HOXA9  GATA2 --NRIP1  ELF1  --NRIP1 
    ## + ... omitted several edges
    ## 
    ## $SP_17.SP_12_GATA2
    ## IGRAPH fe7badf UNWB 74 299 -- 
    ## + attr: name (v/c), label (v/c), type (v/c), nEnts (v/n), color
    ## | (v/n), size (v/n), weight (e/n)
    ## + edges from fe7badf (vertex names):
    ##  [1] GATA2 --LYL1   GATA2 --ZBTB16 GATA2 --NFE2   LYL1  --NFE2  
    ##  [5] ZBTB16--NFE2   GATA2 --RNF10  LYL1  --RNF10  GATA2 --IKZF2 
    ##  [9] GATA2 --GFI1B  NFE2  --GFI1B  GATA2 --HOXA10 GATA2 --STAT5A
    ## [13] LYL1  --STAT5A NFE2  --STAT5A RNF10 --STAT5A GFI1B --STAT5A
    ## [17] GATA2 --TAL1   LYL1  --TAL1   NFE2  --TAL1   GATA2 --MEIS1 
    ## [21] ZBTB16--MEIS1  HOXA10--MEIS1  GATA2 --PBX1   ZBTB16--PBX1  
    ## [25] MEIS1 --PBX1   GATA2 --ZNF555 GATA2 --NRIP1  HOXA10--NRIP1 
    ## + ... omitted several edges
    ## 
    ## $SP_17.SP_12_ERG
    ## IGRAPH 754bbcc UNWB 48 127 -- 
    ## + attr: name (v/c), label (v/c), type (v/c), nEnts (v/n), color
    ## | (v/n), size (v/n), weight (e/n)
    ## + edges from 754bbcc (vertex names):
    ##  [1] MEIS1 --HOPX     MEIS1 --ERG      HOPX  --ERG      MEIS1 --NRIP1   
    ##  [5] HOPX  --NRIP1    ERG   --NRIP1    ERG   --RPS3     ERG   --ZNF711  
    ##  [9] HOPX  --PROM1    ERG   --PROM1    NRIP1 --PROM1    RPS3  --PROM1   
    ## [13] ERG   --SERPINB1 RPS3  --SERPINB1 ZNF711--SERPINB1 ERG   --RPL31   
    ## [17] RPS3  --RPL31    HOPX  --ICAM3    ERG   --ICAM3    ERG   --FTL     
    ## [21] RPS3  --FTL      HOPX  --ABLIM1   ERG   --ABLIM1   ERG   --RPL3    
    ## [25] RPS3  --RPL3     MEIS1 --AVP      HOPX  --AVP      ERG   --AVP     
    ## + ... omitted several edges
    ## 
    ## $SP_17.SP_12_PBX1
    ## IGRAPH ea3e9af UNWB 57 157 -- 
    ## + attr: name (v/c), label (v/c), type (v/c), nEnts (v/n), color
    ## | (v/n), size (v/n), weight (e/n)
    ## + edges from ea3e9af (vertex names):
    ##  [1] GATA2 --ZBTB16   GATA2 --MEIS1    ZBTB16--MEIS1    ELF1  --MEIS1   
    ##  [5] GATA2 --PBX1     ZBTB16--PBX1     ELF1  --PBX1     ZNF10 --PBX1    
    ##  [9] MEIS1 --PBX1     MEIS1 --FLI1     PBX1  --FLI1     PBX1  --ZNF76   
    ## [13] FLI1  --ZNF76    PBX1  --ZNF786   GATA2 --ITGA2B   ZBTB16--ITGA2B  
    ## [17] PBX1  --ITGA2B   GATA2 --SERPINB1 ZBTB16--SERPINB1 PBX1  --SERPINB1
    ## [21] FLI1  --SERPINB1 GATA2 --GUCY1B3  ZBTB16--GUCY1B3  MEIS1 --GUCY1B3 
    ## [25] PBX1  --GUCY1B3  FLI1  --GUCY1B3  GATA2 --PTGS1    ZBTB16--PTGS1   
    ## + ... omitted several edges
    ## 
    ## $SP_17.SP_12_NRIP1
    ## IGRAPH 7954b5e UNWB 75 422 -- 
    ## + attr: name (v/c), label (v/c), type (v/c), nEnts (v/n), color
    ## | (v/n), size (v/n), weight (e/n)
    ## + edges from 7954b5e (vertex names):
    ##  [1] GATA2 --HOXA10  GATA2 --MEIS1   ELF1  --MEIS1   HOXA10--MEIS1  
    ##  [5] H2AFY --MEIS1   ELF1  --SSBP2   MEIS1 --SSBP2   HOXA10--HOPX   
    ##  [9] MEIS1 --HOPX    SSBP2 --HOPX    HOPX  --ELK3    MEIS1 --ERG    
    ## [13] HOPX  --ERG     GATA2 --NRIP1   YBX3  --NRIP1   ELF1  --NRIP1  
    ## [17] HMGA2 --NRIP1   ZNF776--NRIP1   HOXA10--NRIP1   H2AFY --NRIP1  
    ## [21] MEIS1 --NRIP1   SSBP2 --NRIP1   HOPX  --NRIP1   ELK3  --NRIP1  
    ## [25] ERG   --NRIP1   GATA2 --TGIF2   NRIP1 --TGIF2   YBX3  --ZFP36L2
    ## + ... omitted several edges

    regulators <- c('JARID2', 'DNMT1', 'SATB1', 'TRIM28')
    nets <- regulatornetwork(x, regulators, 5, 2, 5, 9, 'results/regulator_networks_down.pdf')

![](stemnet_reprogramming_files/figure-markdown_strict/grnscore2-3.png)
